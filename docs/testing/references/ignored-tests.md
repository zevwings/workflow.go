# è¢«è·³è¿‡æµ‹è¯•è§„èŒƒ

> æœ¬æ–‡æ¡£å®šä¹‰è¢«è·³è¿‡æµ‹è¯•çš„æ–‡æ¡£è§„èŒƒã€‚

---

## ğŸ“‹ ç›®å½•

- [ç»Ÿä¸€æ–‡æ¡£æ ¼å¼](#-ç»Ÿä¸€æ–‡æ¡£æ ¼å¼)
- [å¸¸è§è·³è¿‡åŸå› ](#-å¸¸è§è·³è¿‡åŸå› )
- [å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ](#-å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ)
- [æ”¹è¿›è¢«è·³è¿‡çš„æµ‹è¯•](#-æ”¹è¿›è¢«è·³è¿‡çš„æµ‹è¯•)

---

## ç»Ÿä¸€æ–‡æ¡£æ ¼å¼

æ‰€æœ‰è¢«è·³è¿‡çš„æµ‹è¯•éƒ½åº”è¯¥åŒ…å«ä»¥ä¸‹5ä¸ªéƒ¨åˆ†çš„æ–‡æ¡£æ³¨é‡Šï¼š

```go
// TestFunctionName tests the function with a specific scenario.
//
// ## æµ‹è¯•ç›®çš„
// éªŒè¯/æµ‹è¯•...ï¼ˆè¯´æ˜æµ‹è¯•éªŒè¯ä»€ä¹ˆåŠŸèƒ½ï¼‰
//
// ## ä¸ºä»€ä¹ˆè¢«è·³è¿‡
// - **ä¸»è¦åŸå› **: ...
// - **æ¬¡è¦åŸå› **: ...
// - **ä½¿ç”¨åœºæ™¯**: ...
//
// ## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ
// ```bash
// go test -run TestFunctionName ./...
// ```
// ï¼ˆå¦‚é€‚ç”¨ï¼‰é¢å¤–çš„è¿è¡Œè¯´æ˜æˆ–äº¤äº’æ­¥éª¤
//
// ## æµ‹è¯•åœºæ™¯
// 1. ...
// 2. ...
// 3. ...
//
// ## é¢„æœŸè¡Œä¸º
// - ...
// - ...
func TestFunctionName(t *testing.T) {
    t.Skip("ç®€çŸ­åŸå› ")
    // æµ‹è¯•ä»£ç 
}
```

---

## å¸¸è§è·³è¿‡åŸå› 

### 1. ç”¨æˆ·äº¤äº’æµ‹è¯•

**åŸå› **ï¼š
- éœ€è¦ç”¨æˆ·åœ¨ç»ˆç«¯ä¸­è¿›è¡Œäº¤äº’æ“ä½œ
- CI ç¯å¢ƒæ— æ³•æä¾›äº¤äº’å¼è¾“å…¥

**ç¤ºä¾‹**ï¼š
```go
// TestInteractiveSetup tests the interactive setup process.
//
// ## æµ‹è¯•ç›®çš„
// éªŒè¯äº¤äº’å¼é…ç½®è®¾ç½®æµç¨‹
//
// ## ä¸ºä»€ä¹ˆè¢«è·³è¿‡
// - **ä¸»è¦åŸå› **: éœ€è¦ç”¨æˆ·åœ¨ç»ˆç«¯ä¸­è¿›è¡Œäº¤äº’æ“ä½œ
// - **æ¬¡è¦åŸå› **: CI ç¯å¢ƒä¸æ”¯æŒäº¤äº’å¼è¾“å…¥
//
// ## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ
// ```bash
// go test -run TestInteractiveSetup ./...
// ```
func TestInteractiveSetup(t *testing.T) {
    t.Skip("éœ€è¦ç”¨æˆ·äº¤äº’")
    // æµ‹è¯•ä»£ç 
}
```

### 2. ç½‘ç»œè¯·æ±‚æµ‹è¯•

**åŸå› **ï¼š
- éœ€è¦å®é™…çš„ç½‘ç»œè¿æ¥åˆ°å¤–éƒ¨ API
- éœ€è¦æœ‰æ•ˆçš„ API å¯†é’¥æˆ–è®¤è¯å‡­æ®
- CI æˆæœ¬è€ƒè™‘

**ç¤ºä¾‹**ï¼š
```go
// TestRealGitHubAPI tests the GitHub API integration with real API.
//
// ## æµ‹è¯•ç›®çš„
// éªŒè¯ä¸çœŸå® GitHub API çš„é›†æˆ
//
// ## ä¸ºä»€ä¹ˆè¢«è·³è¿‡
// - **ä¸»è¦åŸå› **: éœ€è¦çœŸå®çš„ GitHub API è¿æ¥å’Œ API å¯†é’¥
// - **æ¬¡è¦åŸå› **: CI æˆæœ¬è€ƒè™‘ï¼Œé¿å…äº§ç”Ÿ API è°ƒç”¨è´¹ç”¨
//
// ## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ
// ```bash
// GITHUB_TOKEN=your_token go test -run TestRealGitHubAPI ./...
// ```
func TestRealGitHubAPI(t *testing.T) {
    t.Skip("éœ€è¦çœŸå® GitHub API")
    // æµ‹è¯•ä»£ç 
}
```

**æ”¹è¿›å»ºè®®**ï¼šä½¿ç”¨ `httptest` åˆ›å»º Mock HTTP æœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯è·³è¿‡æµ‹è¯•ã€‚

### 3. æ—¶é—´ç›¸å…³æµ‹è¯•

**åŸå› **ï¼š
- æ¶‰åŠçœŸå®æ—¶é—´å»¶è¿Ÿ
- æµ‹è¯•è¿è¡Œæ—¶é—´é•¿
- CI æ—¶é—´é™åˆ¶

**ç¤ºä¾‹**ï¼š
```go
// TestLongRunningProcess tests a long-running process.
//
// ## æµ‹è¯•ç›®çš„
// éªŒè¯é•¿æ—¶é—´è¿è¡Œçš„å¤„ç†æµç¨‹
//
// ## ä¸ºä»€ä¹ˆè¢«è·³è¿‡
// - **ä¸»è¦åŸå› **: æµ‹è¯•éœ€è¦ç­‰å¾…å®é™…çš„æ—¶é—´æµé€ï¼ˆ> 1åˆ†é’Ÿï¼‰
// - **æ¬¡è¦åŸå› **: CI æ—¶é—´é™åˆ¶ï¼Œé¿å…å ç”¨è¿‡å¤šæ—¶é—´
//
// ## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ
// ```bash
// go test -run TestLongRunningProcess ./...
// ```
func TestLongRunningProcess(t *testing.T) {
    t.Skip("è¿è¡Œæ—¶é—´è¿‡é•¿")
    // æµ‹è¯•ä»£ç 
}
```

**æ”¹è¿›å»ºè®®**ï¼šä½¿ç”¨æ—¶é—´ Mock æˆ–åŠ é€Ÿæ—¶é—´æµé€ã€‚

### 4. ä¿®æ”¹ç³»ç»Ÿé…ç½®çš„æµ‹è¯•

**åŸå› **ï¼š
- ä¼šä¿®æ”¹ç”¨æˆ·çš„é…ç½®æ–‡ä»¶
- å®‰å…¨é£é™©

**ç¤ºä¾‹**ï¼š
```go
// TestModifySystemConfig tests modifying system configuration.
//
// ## æµ‹è¯•ç›®çš„
// éªŒè¯ç³»ç»Ÿé…ç½®ä¿®æ”¹åŠŸèƒ½
//
// ## ä¸ºä»€ä¹ˆè¢«è·³è¿‡
// - **ä¸»è¦åŸå› **: æµ‹è¯•ä¼šä¿®æ”¹ç”¨æˆ·çš„çœŸå®é…ç½®æ–‡ä»¶
// - **æ¬¡è¦åŸå› **: å®‰å…¨é£é™©ï¼Œé¿å…åœ¨ CI æˆ–å¼€å‘ç¯å¢ƒä¸­æ„å¤–ä¿®æ”¹é…ç½®
//
// ## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ
// ```bash
// go test -run TestModifySystemConfig ./...
// ```
func TestModifySystemConfig(t *testing.T) {
    t.Skip("ä¼šä¿®æ”¹ç³»ç»Ÿé…ç½®")
    // æµ‹è¯•ä»£ç 
}
```

**æ”¹è¿›å»ºè®®**ï¼šä½¿ç”¨ `t.TempDir()` å’Œ `t.Setenv()` åˆ›å»ºéš”ç¦»çš„æµ‹è¯•ç¯å¢ƒã€‚

### 5. å¤–éƒ¨æœåŠ¡æµ‹è¯•

**åŸå› **ï¼š
- éœ€è¦è¿æ¥å®é™…çš„å¤–éƒ¨æœåŠ¡
- æœåŠ¡å¯èƒ½ä¸å¯ç”¨

**ç¤ºä¾‹**ï¼š
```go
// TestExternalService tests integration with external service.
//
// ## æµ‹è¯•ç›®çš„
// éªŒè¯ä¸å¤–éƒ¨æœåŠ¡çš„é›†æˆ
//
// ## ä¸ºä»€ä¹ˆè¢«è·³è¿‡
// - **ä¸»è¦åŸå› **: éœ€è¦è¿æ¥å®é™…çš„å¤–éƒ¨æœåŠ¡
// - **æ¬¡è¦åŸå› **: å¤–éƒ¨æœåŠ¡å¯èƒ½ä¸å¯ç”¨ï¼Œå¯¼è‡´æµ‹è¯•ä¸ç¨³å®š
//
// ## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ
// ```bash
// EXTERNAL_SERVICE_URL=http://service.example.com go test -run TestExternalService ./...
// ```
func TestExternalService(t *testing.T) {
    t.Skip("éœ€è¦å¤–éƒ¨æœåŠ¡")
    // æµ‹è¯•ä»£ç 
}
```

**æ”¹è¿›å»ºè®®**ï¼šä½¿ç”¨ Mock æœåŠ¡å™¨æ›¿ä»£çœŸå®æœåŠ¡ã€‚

---

## å¦‚ä½•æ‰‹åŠ¨è¿è¡Œ

### è¿è¡Œå•ä¸ªè¢«è·³è¿‡çš„æµ‹è¯•

```bash
# è¿è¡Œç‰¹å®šæµ‹è¯•
go test -run TestFunctionName ./...

# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆåŒ…æ‹¬è¢«è·³è¿‡çš„ï¼‰
go test -run . ./...
```

### ä½¿ç”¨ç¯å¢ƒå˜é‡æ§åˆ¶

```go
func TestConditionalSkip(t *testing.T) {
    if os.Getenv("ENABLE_REAL_API_TESTS") == "" {
        t.Skip("éœ€è¦è®¾ç½® ENABLE_REAL_API_TESTS ç¯å¢ƒå˜é‡")
    }
    // æµ‹è¯•ä»£ç 
}
```

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡åè¿è¡Œ
ENABLE_REAL_API_TESTS=1 go test -run TestConditionalSkip ./...
```

---

## æ”¹è¿›è¢«è·³è¿‡çš„æµ‹è¯•

æ ¹æ®æµ‹è¯•ä»£ç å®¡æŸ¥ï¼Œ**å¤§éƒ¨åˆ†è¢«è·³è¿‡çš„æµ‹è¯•å¯ä»¥é€šè¿‡ä½¿ç”¨ Mock å’Œæµ‹è¯•ç¯å¢ƒéš”ç¦»æ¥ç§»é™¤ `t.Skip()`**ã€‚

### å¯ä»¥ç§»é™¤ `t.Skip()` çš„æµ‹è¯•åˆ†ç±»

#### 1. ç½‘ç»œè¯·æ±‚æµ‹è¯• - åº”ä½¿ç”¨ Mockï¼ˆçº¦15-20ä¸ªï¼‰

**ç°çŠ¶**ï¼šè¿™äº›æµ‹è¯•éœ€è¦çœŸå®çš„ GitHub/Jira APIï¼Œä½†å¯ä»¥ä½¿ç”¨ `httptest` åˆ›å»º Mock æœåŠ¡å™¨ã€‚

**æ”¹è¿›æ–¹æ¡ˆ**ï¼šä½¿ç”¨ `httptest` åˆ›å»º Mock HTTP æœåŠ¡å™¨ã€‚

**æ­¥éª¤**ï¼š
1. è¯†åˆ«éœ€è¦çœŸå® API çš„æµ‹è¯•
2. ä½¿ç”¨ `httptest.NewServer()` åˆ›å»º Mock ç«¯ç‚¹
3. ä½¿ç”¨æµ‹è¯•æ•°æ®å·¥å‚ç”Ÿæˆæµ‹è¯•æ•°æ®
4. ç§»é™¤ `t.Skip()` æ ‡è®°

**ç¤ºä¾‹**ï¼š
```go
// ä¹‹å‰
func TestCreatePR(t *testing.T) {
    t.Skip("éœ€è¦çœŸå® GitHub API")
    // è°ƒç”¨çœŸå® API...
}

// ä¹‹å
func TestCreatePR(t *testing.T) {
    // åˆ›å»º Mock HTTP æœåŠ¡å™¨
    server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"number": 123, "title": "Test PR"}`))
    }))
    defer server.Close()

    // ä½¿ç”¨ Mock æœåŠ¡å™¨è¿›è¡Œæµ‹è¯•
    client := NewHTTPClient(server.URL)
    result, err := client.CreatePR("owner", "repo", PRData{})
    assert.NoError(t, err)
    assert.Equal(t, 123, result.Number)
}
```

#### 2. Git ä»“åº“æµ‹è¯• - åº”ä½¿ç”¨æµ‹è¯•ç¯å¢ƒéš”ç¦»ï¼ˆçº¦5-8ä¸ªï¼‰

**æ”¹è¿›æ–¹æ¡ˆ**ï¼šä½¿ç”¨ `t.TempDir()` åˆ›å»ºä¸´æ—¶ Git ä»“åº“ã€‚

**ç¤ºä¾‹**ï¼š
```go
// ä¹‹å‰
func TestGitCommand(t *testing.T) {
    t.Skip("éœ€è¦çœŸå® Git ä»“åº“")
    // ä½¿ç”¨çœŸå® Git ä»“åº“...
}

// ä¹‹å
func TestGitCommand(t *testing.T) {
    // åˆ›å»ºä¸´æ—¶ç›®å½•
    tempDir := t.TempDir()

    // åˆå§‹åŒ– Git ä»“åº“
    err := exec.Command("git", "init", tempDir).Run()
    require.NoError(t, err)

    // é…ç½® Git ç”¨æˆ·
    exec.Command("git", "config", "user.name", "Test User").Run()
    exec.Command("git", "config", "user.email", "test@example.com").Run()

    // æ‰§è¡Œ Git å‘½ä»¤æµ‹è¯•
    // ...
}
```

#### 3. ç³»ç»Ÿé…ç½®æµ‹è¯• - åº”ä½¿ç”¨ç¯å¢ƒéš”ç¦»ï¼ˆçº¦3-5ä¸ªï¼‰

**æ”¹è¿›æ–¹æ¡ˆ**ï¼šä½¿ç”¨ `t.TempDir()` å’Œ `t.Setenv()` åˆ›å»ºéš”ç¦»çš„æµ‹è¯•ç¯å¢ƒã€‚

**ç¤ºä¾‹**ï¼š
```go
// ä¹‹å‰
func TestModifyConfig(t *testing.T) {
    t.Skip("ä¼šä¿®æ”¹ç³»ç»Ÿé…ç½®")
    // ä¿®æ”¹çœŸå®é…ç½®...
}

// ä¹‹å
func TestModifyConfig(t *testing.T) {
    // åˆ›å»ºä¸´æ—¶ç›®å½•
    tempDir := t.TempDir()
    t.Setenv("HOME", tempDir)

    // åœ¨éš”ç¦»ç¯å¢ƒä¸­æµ‹è¯•é…ç½®ä¿®æ”¹
    // ...
}
```

#### 4. LLM API æµ‹è¯•ï¼ˆéœ€è¦ç‰¹æ®Šå¤„ç†ï¼‰

**å»ºè®®**ï¼šä¿ç•™ `t.Skip()`ï¼Œä½†å¯ä»¥æ·»åŠ ç¯å¢ƒå˜é‡æ§åˆ¶ã€‚

```go
func TestLLMAPI(t *testing.T) {
    if os.Getenv("ENABLE_LLM_TESTS") == "" {
        t.Skip("éœ€è¦è®¾ç½® ENABLE_LLM_TESTS ç¯å¢ƒå˜é‡")
    }
    // æµ‹è¯•ä»£ç 
}
```

---

## ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•ç¼–å†™è§„èŒƒ](../writing.md) - æµ‹è¯•ç¼–å†™è§„èŒƒ
- [Mock æµ‹è¯•æŒ‡å—](./mock-server.md) - Mock æµ‹è¯•è¯¦ç»†ä½¿ç”¨æ–¹æ³•
- [æµ‹è¯•ç¯å¢ƒå·¥å…·æŒ‡å—](./environments.md) - æµ‹è¯•ç¯å¢ƒå·¥å…·è¯¦ç»†ä½¿ç”¨æ–¹æ³•

---

**æœ€åæ›´æ–°**: 2025-01-28
